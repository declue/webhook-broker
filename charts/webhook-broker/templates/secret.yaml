{{- if not (and .Values.secrets.github.existingSecret .Values.secrets.jwt.existingSecret .Values.secrets.encryption.existingSecret .Values.secrets.metrics.existingSecret) }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "webhook-broker.secretName" . }}
  labels:
    {{- include "webhook-broker.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.externalServices.database.url }}
  DATABASE_URL: {{ .Values.externalServices.database.url | quote }}
  {{- end }}
  {{- if not .Values.secrets.github.existingSecret }}
  GITHUB_CLIENT_ID: {{ .Values.secrets.github.clientId | quote }}
  GITHUB_CLIENT_SECRET: {{ .Values.secrets.github.clientSecret | quote }}
  GITHUB_CALLBACK_URL: {{ .Values.secrets.github.callbackUrl | quote }}
  GITHUB_WEBHOOK_SECRET: {{ .Values.secrets.github.webhookSecret | quote }}
  {{- end }}
  {{- if and .Values.secrets.gitlab.webhookSecret (not .Values.secrets.gitlab.existingSecret) }}
  GITLAB_WEBHOOK_SECRET: {{ .Values.secrets.gitlab.webhookSecret | quote }}
  {{- end }}
  {{- if and .Values.secrets.jira.webhookSecret (not .Values.secrets.jira.existingSecret) }}
  JIRA_WEBHOOK_SECRET: {{ .Values.secrets.jira.webhookSecret | quote }}
  {{- end }}
  {{- if not .Values.secrets.jwt.existingSecret }}
  JWT_SECRET: {{ .Values.secrets.jwt.secret | quote }}
  {{- end }}
  {{- if not .Values.secrets.encryption.existingSecret }}
  ENCRYPTION_KEY: {{ .Values.secrets.encryption.key | quote }}
  {{- end }}
  {{- if not .Values.secrets.metrics.existingSecret }}
  METRICS_TOKEN: {{ .Values.secrets.metrics.token | quote }}
  {{- end }}
{{- end }}
